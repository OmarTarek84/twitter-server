(this["webpackJsonptwitter-clone"]=this["webpackJsonptwitter-clone"]||[]).push([[10],{140:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var r=a(46);function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var a=[],r=!0,n=!1,s=void 0;try{for(var c,o=e[Symbol.iterator]();!(r=(c=o.next()).done)&&(a.push(c.value),!t||a.length!==t);r=!0);}catch(u){n=!0,s=u}finally{try{r||null==o.return||o.return()}finally{if(n)throw s}}return a}}(e,t)||Object(r.a)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},141:function(e,t,a){"use strict";a.d(t,"d",(function(){return i})),a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return p})),a.d(t,"c",(function(){return f}));var r=a(32),n=a.n(r),s=a(42),c=a(43),o=a(6),u=a(12),i=function(e){return function(){var t=Object(s.a)(n.a.mark((function t(a,r){return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,c.a.post("/auth/signup",e);case 3:u.a.push("/login"),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),a({type:o.USER_ERROR,errorMessage:t.t0.response&&t.t0.response.data&&t.t0.response.data.message?t.t0.response.data.message:t.t0.message});case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e,a){return t.apply(this,arguments)}}()},l=function(e){return function(){var t=Object(s.a)(n.a.mark((function t(a,r){var s;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a({type:o.AUTH_LOADING}),t.prev=1,t.next=4,c.a.post("/auth/login",e);case 4:s=t.sent,localStorage.setItem("accessToken",s.data.accessToken),localStorage.setItem("email",s.data.userDetails.email),localStorage.setItem("userName",s.data.userDetails.username),localStorage.setItem("firstName",s.data.userDetails.firstName),localStorage.setItem("lastName",s.data.userDetails.lastName),localStorage.setItem("profilePic",s.data.userDetails.profilePic),u.a.push("/"),a({type:o.LOGIN,token:s.data.accessToken,userDetails:s.data.userDetails}),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(1),a({type:o.USER_ERROR,errorMessage:t.t0.response&&t.t0.response.data&&t.t0.response.data.message?t.t0.response.data.message:t.t0.message});case 18:case"end":return t.stop()}}),t,null,[[1,15]])})));return function(e,a){return t.apply(this,arguments)}}()},p=function(e){return function(){var t=Object(s.a)(n.a.mark((function t(a,r){var s;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,c.a.put("/user/pinPost",{postId:e},{headers:{Authorization:"Bearer "+(r().user.token||localStorage.getItem("accessToken"))}});case 3:s=t.sent,console.log(s.data),a({type:o.PIN_POST,pinnedPost:s.data.pinnedPost,pintype:s.data.type}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),a({type:o.USER_ERROR,errorMessage:t.t0.response&&t.t0.response.data&&t.t0.response.data.message?t.t0.response.data.message:t.t0.message});case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,a){return t.apply(this,arguments)}}()},f=function(e,t,a,r){return function(){var u=Object(s.a)(n.a.mark((function s(u,i){var l;return n.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,u({type:o.USERS_LOADING}),n.next=4,c.a.get("/user/search?currentPage=".concat(e,"&pageSize=").concat(t,"&search=").concat(a,"&filterUsernames=").concat(r),{headers:{Authorization:"Bearer "+(i().user.token||localStorage.getItem("accessToken"))}});case 4:l=n.sent,console.log("SEARCH USERS RESULT",l.data),u({type:o.FETCH_USERS,userDetails:l.data.userDetails,currentPageUser:l.data.currentPage,pageSizeUser:l.data.pageSize,pagesUser:l.data.pages,totalItemsCountUser:l.data.totalItemsCount}),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),u({type:o.USER_ERROR,errorMessage:n.t0.response&&n.t0.response.data&&n.t0.response.data.message?n.t0.response.data.message:n.t0.message});case 12:case"end":return n.stop()}}),s,null,[[0,9]])})));return function(e,t){return u.apply(this,arguments)}}()}},144:function(e,t,a){"use strict";a.d(t,"c",(function(){return l})),a.d(t,"b",(function(){return p})),a.d(t,"a",(function(){return f})),a.d(t,"d",(function(){return d}));var r=a(32),n=a.n(r),s=a(42),c=a(43),o=a(29),u=a.n(o),i=a(6),l=function(e,t,a){return function(){var r=Object(s.a)(n.a.mark((function r(s,o){var u,l,p;return n.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,1===t&&s({type:i.CHAT_LOADING}),u=o().user&&o().user.token?o().user.token:localStorage.getItem("accessToken"),r.next=5,c.a.get("/chat/getMessages?chatId=".concat(e,"&currentPage=").concat(t,"&pageSize=").concat(a),{headers:{Authorization:"Bearer "+u}});case 5:l=r.sent,p=l.data,s({type:i.FETCH_CHAT_MESSAGES,chat:p.chat,messages:p.messages,currentPage:p.currentPage,pages:p.pages,messagesCount:p.messagesCount,pageSize:p.pageSize}),r.next=13;break;case 10:r.prev=10,r.t0=r.catch(0),s({type:i.CHAT_MESSAGES_ERROR,error:r.t0.response&&r.t0.response.data&&r.t0.response.data.message?r.t0.response.data.message:r.t0.message});case 13:case"end":return r.stop()}}),r,null,[[0,10]])})));return function(e,t){return r.apply(this,arguments)}}()},p=function(e,t){return function(){var a=Object(s.a)(n.a.mark((function a(r,s){var o,u,l;return n.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,r({type:i.CHAT_LOADING}),a.next=4,c.a.post("/chat/createChat?isGroupChat=".concat(t),{users:e},{headers:{Authorization:"Bearer "+(s().user.token||localStorage.getItem("accessToken"))}});case 4:return o=a.sent,u=o.data,a.next=8,r({type:i.CREATE_CHAT,chat:u});case 8:return l=a.sent,a.abrupt("return",l);case 12:a.prev=12,a.t0=a.catch(0),console.log(a.t0);case 15:case"end":return a.stop()}}),a,null,[[0,12]])})));return function(e,t){return a.apply(this,arguments)}}()},f=function(e,t){return function(){var a=Object(s.a)(n.a.mark((function a(r,s){return n.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,c.a.put("/chat/changeChatName?chatId=".concat(e),{chatName:t},{headers:{Authorization:"Bearer "+(s().user.token||localStorage.getItem("accessToken"))}});case 3:r({type:i.CHANGE_CHAT_NAME,chatName:t}),a.next=9;break;case 6:a.prev=6,a.t0=a.catch(0),console.log(a.t0);case 9:case"end":return a.stop()}}),a,null,[[0,6]])})));return function(e,t){return a.apply(this,arguments)}}()},d=function(e,t){return function(){var a=Object(s.a)(n.a.mark((function a(r,s){var o;return n.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return o=(new Date).toISOString(),r({type:i.SEND_MESSAGE,message:{content:t,_id:o,createdAt:new Date,updatedAt:new Date,sender:{coverPhoto:s().user.userDetails.coverPhoto,firstName:s().user.userDetails.firstName,lastName:s().user.userDetails.lastName,profilePic:s().user.userDetails.profilePic,username:s().user.userDetails.username},readBy:[],chat:e,error:!1}}),"/",u()("/").emit("sendMessage",{sender:{firstName:s().user.userDetails.firstName,lastName:s().user.userDetails.lastName,profilePic:s().user.userDetails.profilePic,username:s().user.userDetails.username,email:s().user.userDetails.email},content:t,chatId:e,createdAt:new Date}),a.prev=5,a.next=8,c.a.post("/chat/sendMessage?chatId=".concat(e),{content:t},{headers:{Authorization:"Bearer "+(s().user.token||localStorage.getItem("accessToken"))}});case 8:r({type:i.UPDATE_LATEST_MESSAGE,content:t,user:{coverPhoto:s().user.userDetails.coverPhoto,firstName:s().user.userDetails.firstName,lastName:s().user.userDetails.lastName,profilePic:s().user.userDetails.profilePic,username:s().user.userDetails.username},chatId:e}),a.next=15;break;case 11:a.prev=11,a.t0=a.catch(5),console.log(a.t0),r({type:i.SEND_MESSAGE_ERROR,msgId:o});case 15:case"end":return a.stop()}}),a,null,[[5,11]])})));return function(e,t){return a.apply(this,arguments)}}()}},145:function(e,t,a){"use strict";var r=a(2),n=(a(0),a(146),a(13));t.a=function(e){var t=e.username,a=e.profilePic,s=e.firstName,c=e.lastName,o=e.loggedinFollowing,u=e.followUser,i=e.followLoading,l=e.followIndex,p=e.userIndex,f=e.parentUserClicked,d=o?o.findIndex((function(e){return e.username===t}))>-1:null;return Object(r.jsxs)("div",{className:"userDet",onClick:f,children:[Object(r.jsx)("div",{className:"details",children:Object(r.jsxs)("div",{className:"picAndName",children:[Object(r.jsx)("img",{src:a,alt:t}),Object(r.jsxs)(n.a,{className:"firstlastname",to:"/profile/".concat(t),onClick:function(e){return e.stopPropagation()},children:[s," ",c]}),Object(r.jsxs)("span",{className:"username",children:["@",t]})]})}),Object(r.jsx)("div",{className:"followBtn",style:{display:t!==localStorage.getItem("userName")&&u&&o?"flex":"none"},children:Object(r.jsx)("button",{style:{backgroundColor:d?"#00ACEE":"white",color:d?"white":"#00ACEE"},disabled:i&&l===p,onClick:u,children:d?"Following":"Follow"})})]},t)}},146:function(e,t,a){},182:function(e,t,a){},189:function(e,t,a){"use strict";a.r(t);var r=a(2),n=a(3),s=a(140),c=a(0),o=a(21),u=a(6),i=a(141),l=a(145),p=a(12),f=(a(182),a(144)),d=a(44);t.default=function(){var e=Object(c.useState)(""),t=Object(s.a)(e,2),a=t[0],m=t[1],h=Object(c.useState)([]),g=Object(s.a)(h,2),v=g[0],b=g[1],j=Object(c.useRef)(),O=Object(o.b)(),S=Object(o.c)((function(e){return e.userSearch})).users,x=Object(o.c)((function(e){return e.chat})).chatLoading,N=function(e){"Backspace"!=e.key||j.current.value||(console.log(v),b((function(e){return e.filter((function(t,a){return a!==e.length-1}))})))};Object(c.useEffect)((function(){document.addEventListener("keydown",N)}),[]),Object(c.useEffect)((function(){if(a){var e=setTimeout((function(){var e=v.map((function(e){return e.username})).join(",");O(Object(i.c)(0,1e3,a,e))}),400);return function(){clearTimeout(e),document.removeEventListener("keydown",N)}}O({type:u.CLEAR_USER_SEARCH})}),[a,O,v]);var y=S.map((function(e,t){return Object(r.jsx)(l.a,{firstName:e.firstName,lastName:e.lastName,username:e.username,profilePic:e.profilePic,parentUserClicked:function(){return function(e){b((function(t){return[].concat(Object(n.a)(t),[e])})),O({type:u.CLEAR_USER_SEARCH}),m("")}(e)}},e.username)}));return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("div",{className:"newmessage",children:[Object(r.jsx)("div",{className:"h2",children:Object(r.jsx)("h2",{children:"New Message"})}),Object(r.jsxs)("div",{className:"personsinput",children:[Object(r.jsx)("span",{children:"To: "}),Object(r.jsxs)("div",{className:"users-input",children:[Object(r.jsx)("div",{className:"users",children:v.map((function(e){return Object(r.jsxs)("span",{children:[e.firstName," ",e.lastName]},e.username)}))}),Object(r.jsx)("div",{className:"input",children:Object(r.jsx)("input",{type:"text",autoComplete:"off",name:"person",placeholder:"Type the name of the person/s",value:a,ref:j,onFocus:function(){return O(Object(i.c)(0,1e3,"",v.map((function(e){return e.username}))))},onChange:function(e){return m(e.target.value)}})})]})]}),S&&S.length>0&&Object(r.jsx)("div",{className:"usersTable",children:y})]}),Object(r.jsx)("div",{className:"createChatBtn",children:x?Object(r.jsx)(d.a,{width:"30px"}):Object(r.jsx)("button",{onClick:function(){var e=v.map((function(e){return e.username}));O(Object(f.b)(e,!0)).then((function(){p.a.push("/messages")}))},disabled:v.length<=0,children:"Create Chat"})})]})}}}]);
//# sourceMappingURL=10.a50760dd.chunk.js.map