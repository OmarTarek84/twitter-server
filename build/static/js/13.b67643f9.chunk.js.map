{"version":3,"sources":["components/Profile/Tabs/Tabs.js","components/Profile/ImageUploadModal/ImageUploadModal.js","components/Profile/Profile.js","store/Actions/chat.js"],"names":["timeDifference","current","previous","msPerMinute","msPerHour","msPerDay","msPerMonth","msPerYear","elapsed","Math","round","TabsPosts","posts","deletePostReqGoHome","retweetReq","viewSinglePostReq","likePostReq","postActionLoading","retweetActionLoading","selectTabIndex","goToProfile","submitReplyReq","disableReply","pinPost","pinnedPostId","renderPosts","map","post","Post","postId","_id","firstName","postedBy","lastName","username","content","createdAt","Date","retweetData","profilePic","likes","loggedInUsername","localStorage","getItem","retweetUsers","combineretweetsAndPosts","replyTo","replyToUsername","originalPost","replyPostTypeReplyToUsername","deletePost","onSelect","ImageUploadModal","closeUploadModal","uploadProfilePic","photoType","useState","upImg","setUpImg","imgRef","useRef","previewCanvasRef","unit","width","aspect","crop","setCrop","completedCrop","setCompletedCrop","onLoad","useCallback","img","useEffect","image","canvas","scaleX","naturalWidth","scaleY","naturalHeight","height","ctx","getContext","pixelRatio","window","devicePixelRatio","setTransform","imageSmoothingQuality","drawImage","x","y","className","onClick","type","name","accept","onChange","e","target","files","length","reader","FileReader","addEventListener","result","readAsDataURL","ref","style","src","onImageLoaded","c","onComplete","disabled","toDataURL","initialState","userLoading","profile","error","combinedPostsAndRetweets","followLoading","imageUploadProgressRunning","imageUploadProgress","reducer","state","action","retweets","combinedPostsAndRetweetsForRetweet","targetedPostIndexForRetweet","findIndex","o","postretweetUsers","u","filter","unshift","postsArray","tabIndex","replies","targetedPostIndex","allPostLikes","likeUserFoundIndex","like","splice","push","allReplies","foundReplyPostIndex","r","replyPostId","resType","followers","follower","p","progress","coverPhoto","Profile","props","useReducer","profileState","dispatch","settabIndex","ifFollowing","setifFollowing","open","modalOpen","setModalOpen","pinToastId","replyToastId","retweetToastId","dispatch2","useDispatch","useSelector","user","token","userDetails","chatLoading","chat","originalPostId","likePost","toast","warning","retweetPost","then","dismiss","success","history","backgroundGreenPostId","tabindex","formData","a","replyPost","reply","goToFollowList","index","following","pinPostUser","followUser","axios","put","headers","Authorization","response","FOLLOW_USER","newfollowingUser","data","email","openUploadModal","chatWithUser","createChat","disResult","get","match","params","console","log","followUserBool","message","getProfile","urltoFile","url","filename","mimeType","fetch","res","arrayBuffer","File","fileUploadProgress","progressEvent","percentageLoaded","loaded","total","base64DataUrl","imagePath","fileObj","onUploadProgress","CHANGE_PROFILE_PIC","getTime","CHANGE_COVER_PHOTO","backgroundColor","display","alt","WebkitFilter","msFilter","percent","strokeWidth","strokeColor","Spinner","color","marginTop","pinnedPost","getChatMsgs","chatId","getState","CHAT_LOADING","FETCH_CHAT_MESSAGES","CHAT_MESSAGES_ERROR","users","isGroupChat","CREATE_CHAT","changeChatName","chatName","CHANGE_CHAT_NAME"],"mappings":"4TAMMA,EAAiB,SAACC,EAASC,GAC/B,IAAMC,EAAc,IACdC,EAAYD,KACZE,EAAWD,MACXE,EAAaD,OACbE,EAAYF,QAEZG,EAAUP,EAAUC,EAE1B,OAAIM,EAAUL,EACRK,EAAU,IAAO,GAAW,WACzBC,KAAKC,MAAMF,EAAU,KAAQ,eAC3BA,EAAUJ,EACZK,KAAKC,MAAMF,EAAUL,GAAe,eAClCK,EAAUH,EACZI,KAAKC,MAAMF,EAAUJ,GAAa,aAChCI,EAAUF,EACZG,KAAKC,MAAMF,EAAUH,GAAY,YAC/BG,EAAUD,EACZE,KAAKC,MAAMF,EAAUF,GAAc,cAEnCG,KAAKC,MAAMF,EAAUD,GAAa,cA8E9BI,EA1EG,SAAC,GAcZ,IAbLC,EAaI,EAbJA,MACAC,EAYI,EAZJA,oBACAC,EAWI,EAXJA,WACAC,EAUI,EAVJA,kBACAC,EASI,EATJA,YACAC,EAQI,EARJA,kBACAC,EAOI,EAPJA,qBACAC,EAMI,EANJA,eACAC,EAKI,EALJA,YACAC,EAII,EAJJA,eACAC,EAGI,EAHJA,aACAC,EAEI,EAFJA,QACAC,EACI,EADJA,aAGMC,EAAcb,EAAMc,KAAI,SAACC,GAC7B,OACE,cAACC,EAAA,EAAD,CAEEC,OAAQF,EAAKG,IACbC,UAAWJ,EAAKK,SAASD,UACzBE,SAAUN,EAAKK,SAASC,SACxBC,SAAUP,EAAKK,SAASE,SACxBC,QAASR,EAAKQ,QACdC,UAAWpC,EACT,IAAIqC,KACJ,IAAIA,KAAKV,EAAKQ,QAAUR,EAAKS,UAAYT,EAAKW,YAAYF,YAE5DG,WAAYZ,EAAKK,SAASO,WAC1BvB,YAAaA,EACbwB,MAAOb,EAAKa,MACZvB,kBAAmBA,EACnBwB,iBAAkBC,aAAaC,QAAQ,YACvC7B,WAAYA,EACZI,qBAAsBA,EACtB0B,aAAcjB,EAAKiB,aACnBN,YAAaX,EAAKW,YAClBO,yBAAyB,EACzBC,QAASnB,EAAKmB,SAAW,KACzBC,gBACEpB,EAAKmB,SAAWnB,EAAKmB,QAAQE,aACzBrB,EAAKmB,QAAQE,aAAahB,SAASE,SACnC,KAENe,6BAA8BtB,EAAKK,SAASE,SAC5CnB,kBAAmB,kBAAMA,EAAkBY,EAAKG,IAAKH,EAAKmB,QAAUnB,EAAKmB,QAAQE,aAAalB,IAAK,OACnGoB,WAAYrC,EACZO,YAAaA,EACbE,aAAcA,EACdC,QAAS,kBAAMA,EAAQI,EAAKG,MAC5BN,aAAcA,EACdH,eAAgBA,GAjCXM,EAAKG,QAsChB,OACE,eAAC,IAAD,CAAMqB,SAAUhC,EAAhB,UACE,eAAC,IAAD,WACE,cAAC,IAAD,oBACA,cAAC,IAAD,yBAGF,cAAC,IAAD,UACGM,IAEH,cAAC,IAAD,UACGA,Q,0DCQM2B,G,OAtGU,SAAC,GAAuD,IAAD,IAApDC,EAAoD,EAApDA,iBAAkBC,EAAkC,EAAlCA,iBAAkBC,EAAgB,EAAhBA,UAAgB,EACpDC,qBADoD,mBACvEC,EADuE,KAChEC,EADgE,KAExEC,EAASC,iBAAO,MAChBC,EAAmBD,iBAAO,MAH8C,EAItDJ,mBAAS,CAAEM,KAAM,IAAKC,MAAO,GAAIC,OAAsB,eAAdT,EAA6B,EAAS,GAAK,IAJ9B,mBAIvEU,EAJuE,KAIjEC,EAJiE,OAKpCV,mBAAS,MAL2B,mBAKvEW,EALuE,KAKxDC,EALwD,KAexEC,EAASC,uBAAY,SAACC,GAC1BZ,EAAO1D,QAAUsE,IAChB,IA0CH,OAnCAC,qBAAU,WACR,GAAKL,GAAkBN,EAAiB5D,SAAY0D,EAAO1D,QAA3D,CAIA,IAAMwE,EAAQd,EAAO1D,QACfyE,EAASb,EAAiB5D,QAC1BgE,EAAOE,EAEPQ,EAASF,EAAMG,aAAeH,EAAMV,MACpCc,EAASJ,EAAMK,cAAgBL,EAAMM,OACrCC,EAAMN,EAAOO,WAAW,MACxBC,EAAaC,OAAOC,iBAE1BV,EAAOX,MAAQE,EAAKF,MAAQmB,EAC5BR,EAAOK,OAASd,EAAKc,OAASG,EAE9BF,EAAIK,aAAaH,EAAY,EAAG,EAAGA,EAAY,EAAG,GAClDF,EAAIM,sBAAwB,OAE5BN,EAAIO,UACFd,EACAR,EAAKuB,EAAIb,EACTV,EAAKwB,EAAIZ,EACTZ,EAAKF,MAAQY,EACbV,EAAKc,OAASF,EACd,EACA,EACAZ,EAAKF,MACLE,EAAKc,WAEN,CAACZ,IAKF,qBAAKuB,UAAU,WAAf,SACE,sBAAKA,UAAU,aAAf,UACE,sBAAKA,UAAU,SAAf,UACE,+CAAgC,eAAdnC,EAA6B,kBAAmB,iBAClE,mBAAGmC,UAAU,cAAcC,QAAStC,OAEtC,sBAAKqC,UAAU,YAAf,UACE,uBACEE,KAAK,OACLC,KAAK,QACLC,OAAO,UACPC,SAhEW,SAACC,GACpB,GAAIA,EAAEC,OAAOC,OAASF,EAAEC,OAAOC,MAAMC,OAAS,EAAG,CAC/C,IAAMC,EAAS,IAAIC,WACnBD,EAAOE,iBAAiB,QAAQ,kBAAM5C,EAAS0C,EAAOG,WACtDH,EAAOI,cAAcR,EAAEC,OAAOC,MAAM,QA8DhC,wBACEO,IAAK5C,EAEL6C,MAAO,CACL3C,MAAOtD,KAAKC,MAAL,iBAAWyD,QAAX,IAAWA,OAAX,EAAWA,EAAeJ,aAA1B,QAAmC,GAC1CgB,OAAQtE,KAAKC,MAAL,iBAAWyD,QAAX,IAAWA,OAAX,EAAWA,EAAeY,cAA1B,QAAoC,MAGhD,cAAC,IAAD,CACE4B,IAAKlD,EACLmD,cAAevC,EACfJ,KAAMA,EACN8B,SAAU,SAACc,GAAD,OAAO3C,EAAQ2C,IACzBC,WAAY,SAACD,GAAD,OAAOzC,EAAiByC,SAGxC,sBAAKnB,UAAU,aAAf,UACE,wBAAQA,UAAU,yBAAyBqB,UAAW9C,IAASJ,EAAiB5D,QAAS0F,QAvErE,WAC1BrC,EAAiBO,EAAiB5D,QAAQ+G,YAAazD,GACvDF,KAqEM,oBAGA,wBAAQqC,UAAU,iBAAiBC,QAAStC,EAA5C,8B,iCC9EJ4D,EAAe,CACnBC,aAAa,EACbC,QAAS,KACTC,MAAO,KACPC,yBAA0B,GAC1BC,eAAe,EACfC,4BAA4B,EAC5BC,oBAAqB,GAGjBC,EAAU,SAACC,EAAOC,GACtB,OAAQA,EAAO/B,MACb,IAAK,eACH,OAAO,2BACF8B,GADL,IAEER,aAAa,EACbE,MAAO,OAEX,IAAK,aACH,OAAO,2BACFM,GADL,IAEER,aAAa,EACbC,QAASQ,EAAOR,QAChBE,yBAAyB,GAAD,mBACnBM,EAAOR,QAAQvG,OADI,YAEnB+G,EAAOR,QAAQS,WAEpBN,eAAe,IAEnB,IAAK,aACH,OAAO,2BACFI,GADL,IAEEN,MAAOO,EAAOP,MACdF,aAAa,EACbI,eAAe,IAEnB,IAAK,UACH,IAAIO,EAAkC,YACjCH,EAAML,0BAELS,EAA8BD,EAAmCE,WACrE,SAACC,GAAD,OAAOA,EAAElG,MAAQ6F,EAAO9F,UAEtBoG,EAAgB,YACfJ,EAAmCC,GACnClF,cAoBL,OAlB0BqF,EAAiBF,WACzC,SAACG,GAAD,OAAOA,EAAEhG,WAAaQ,aAAaC,QAAQ,gBAEpB,EACvBsF,EAAmBA,EAAiBE,QAClC,SAACD,GAAD,OAAOA,EAAEhG,WAAaQ,aAAaC,QAAQ,eAG7CsF,EAAiBG,QAAQ,CACvBrG,UAAWW,aAAaC,QAAQ,aAChCV,SAAUS,aAAaC,QAAQ,YAC/BT,SAAUQ,aAAaC,QAAQ,YAC/BJ,WAAYG,aAAaC,QAAQ,gBAGrCkF,EACEC,GACAlF,aAAeqF,EACV,2BACFP,GADL,IAEEP,QAAQ,2BACHO,EAAMP,SADJ,IAELE,yBAA0BQ,MAGhC,IAAK,YACH,IAAIQ,EAAU,YAAOX,EAAML,0BACH,IAApBM,EAAOW,WACTD,EAAU,YAAOX,EAAMP,QAAQoB,UAEjC,IAAMC,EAAoBH,EAAWN,WACnC,SAACC,GAAD,OAAOA,EAAElG,MAAQ6F,EAAO9F,UAEpB4G,EAAY,YAAOJ,EAAWG,GAAmBhG,OACjDkG,EAAqBD,EAAaV,WACtC,SAACY,GAAD,OAAUA,EAAKzG,WAAaQ,aAAaC,QAAQ,eAanD,OAXI+F,GAAsB,EACxBD,EAAaG,OAAOF,EAAoB,GAExCD,EAAaI,KAAK,CAChB9G,UAAWW,aAAaC,QAAQ,aAChCV,SAAUS,aAAaC,QAAQ,YAC/BT,SAAUQ,aAAaC,QAAQ,YAC/BJ,WAAYG,aAAaC,QAAQ,gBAGrC0F,EAAWG,GAAmBhG,MAAQiG,EACd,IAApBd,EAAOW,SACF,2BACFZ,GADL,IAEEL,yBAA0BgB,IAGrB,2BACFX,GADL,IAEEP,QAAQ,2BACHO,EAAMP,SADJ,IAELoB,QAASF,MAIjB,IAAK,oBACH,IAAMS,EAAU,YAAOpB,EAAMP,QAAQoB,SAC/BQ,EAAsBD,EAAWf,WACrC,SAACiB,GAAD,OAAOA,EAAElH,MAAQ6F,EAAOsB,eAG1B,OADAH,EAAWF,OAAOG,EAAqB,GAChC,2BACFrB,GADL,IAEEP,QAAQ,2BACHO,EAAMP,SADJ,IAELoB,QAAQ,YAAKO,OAGnB,IAAK,iBACH,OAAO,2BACFpB,GADL,IAEEJ,eAAe,IAEnB,IAAK,cACH,MAAuB,QAAnBK,EAAOuB,QACF,2BACFxB,GADL,IAEEP,QAAQ,2BACHO,EAAMP,SADJ,IAELgC,UAAU,GAAD,mBAAMzB,EAAMP,QAAQgC,WAApB,CAA+BxB,EAAOyB,aAEjD9B,eAAe,IAGV,2BACFI,GADL,IAEEP,QAAQ,2BACHO,EAAMP,SADJ,IAELgC,UAAWzB,EAAMP,QAAQgC,UAAUhB,QACjC,SAACkB,GAAD,OAAOA,EAAEnH,WAAayF,EAAOyB,SAASlH,cAG1CoF,eAAe,IAGrB,IAAK,eACH,OAAO,2BACFI,GADL,IAEEH,4BAA4B,EAC5BC,oBAAqBG,EAAO2B,WAEhC,IAAK,qBACH,OAAO,2BACF5B,GADL,IAEEH,4BAA4B,EAC5BC,oBAAqB,EACrBL,QAAQ,2BACHO,EAAMP,SADJ,IAEL5E,WAAYoF,EAAOpF,eAGzB,IAAK,qBACH,OAAO,2BACFmF,GADL,IAEEH,4BAA4B,EAC5BC,oBAAqB,EACrBL,QAAQ,2BACHO,EAAMP,SADJ,IAELoC,WAAY5B,EAAO4B,eAGzB,QACE,OAAO7B,IAkbE8B,UA9aC,SAACC,GAAW,IAAD,EACQC,qBAAWjC,EAASR,GAD5B,mBAClB0C,EADkB,KACJC,EADI,OAEOpG,mBAAS,GAFhB,mBAElB8E,EAFkB,KAERuB,EAFQ,OAGarG,oBAAS,GAHtB,mBAGlBsG,EAHkB,KAGLC,EAHK,OAISvG,mBAAS,CAACwG,MAAM,EAAOpE,KAAM,eAJtC,mBAIlBqE,EAJkB,KAIPC,EAJO,KAMnBC,EAAavG,mBACbwG,EAAexG,mBACfyG,EAAiBzG,mBAEjB0G,EAAYC,cAVO,EAW2BC,aAClD,SAAC9C,GAAD,OAAWA,EAAM/F,QADXV,EAXiB,EAWjBA,kBAAmBC,EAXF,EAWEA,qBAXF,EAcMsJ,aAAY,SAAC9C,GAAD,OAAWA,EAAM+C,QAApDC,EAdiB,EAcjBA,MAAOC,EAdU,EAcVA,YACPC,EAAgBJ,aAAY,SAAC9C,GAAD,OAAWA,EAAMmD,QAA7CD,YAEF5J,EAAc,SAACa,EAAQiJ,GAC3BR,EAAUS,YAASlJ,EAAQiJ,IAG3BlB,EAAS,CACPhE,KAAM,YACN/D,OAAQA,EACRyG,SAAUA,KAIRxH,EAAa,SAACe,EAAQiJ,GAC1BT,EAAepK,QAAU+K,IAAMC,QAAQ,8BACvCX,EAAUY,YAAYrJ,EAAQiJ,IAAiBK,MAAK,WAClDH,IAAMI,QAAQf,EAAepK,SAC7B+K,IAAMK,QAAQ,sBAEhBzB,EAAS,CACPhE,KAAM,UACN/D,OAAQA,KAINhB,EAAsB,SAACgB,EAAQiJ,GACnClB,EAAS,CAAEhE,KAAM,oBAAqBqD,YAAapH,IACnDyI,EAAUpH,YAAWrB,EAAQiJ,KAGzB/J,EAAoB,SAACc,EAAQoH,GACjCqC,IAAQzC,KAAR,gBAAsBI,GAAepH,GAAU,CAC7CA,OAAQoH,GAAepH,EACvB0J,sBAAuB1J,KAIrBT,EAAc,SAACc,GACnBoJ,IAAQzC,KAAR,mBAAyB3G,KAGrBf,EAAiB,SAACqK,GACtB3B,EAAY2B,IAGRnK,EAAc,uCAAG,WAAOoK,EAAU5J,GAAjB,eAAA6J,EAAA,6DACrBtB,EAAanK,QAAU+K,IAAMC,QAAQ,4BADhB,SAEAX,EAAUqB,YAAUF,EAASG,MAAO/J,IAFpC,OAEf0E,EAFe,OAGrByE,IAAMI,QAAQhB,EAAanK,SAC3B+K,IAAMK,QAAQ,sBACdzB,EAAS,CACPhE,KAAM,YACNgG,MAAOrF,EAAO5E,OAPK,2CAAH,wDAWdkK,GAAiB,SAACC,GACtBR,IAAQzC,KAAR,mBAAyBc,EAAaxC,QAAQjF,SAA9C,WAAiE,CAC/DoG,SAAUwD,EACV5J,SAAUyH,EAAaxC,QAAQjF,SAC/BiH,UAAWQ,EAAaxC,QAAQgC,UAChC4C,UAAWpC,EAAaxC,QAAQ4E,UAChChK,UAAW4H,EAAaxC,QAAQpF,UAChCE,SAAU0H,EAAaxC,QAAQlF,YAI7BV,GAAU,SAAAM,GACdsI,EAAWlK,QAAU+K,IAAMC,QAAQ,mBACnCX,EAAU0B,YAAYnK,IAASsJ,MAAK,WAClCH,IAAMI,QAAQjB,EAAWlK,SACzB+K,IAAMK,QAAQ,wBAIZY,GAAU,uCAAG,4BAAAP,EAAA,6DACjB9B,EAAS,CACPhE,KAAM,mBAFS,SAIMsG,IAAMC,IAAN,uBACLxC,EAAaxC,QAAQjF,UACrC,GACA,CACEkK,QAAS,CACPC,cACE,UAAY3B,IAAShI,KAVZ,OAIX4J,EAJW,OAcjBhC,EAAU,CACR1E,KAAM2G,cACNC,iBACEF,EAASG,MAAQH,EAASG,KAAKD,iBAC3BF,EAASG,KAAKD,iBACd,OAER5C,EAAS,CACPhE,KAAM,cACNwD,SAAU,CACRrH,UAAW4I,EAAY5I,UACvBE,SAAU0I,EAAY1I,SACtByK,MAAO/B,EAAY+B,MACnBnK,WAAYoI,EAAYpI,WACxBL,SAAUyI,EAAYzI,UAExBgH,QAASoD,EAASG,KAAK7G,OAEzBoF,IAAMK,QAA+B,QAAvBiB,EAASG,KAAK7G,KAAd,4BAAoD0G,EAASG,KAAKD,iBAAiBzK,UAAnF,YAAgGuK,EAASG,KAAKD,iBAAiBvK,UAA/H,yBAA6JqK,EAASG,KAAKD,iBAAiBzK,UAA5L,YAAyMuK,EAASG,KAAKD,iBAAiBvK,WAC3N,QAAvBqK,EAASG,KAAK7G,KAChBmE,GAAe,GAEfA,GAAe,GApCA,2CAAH,qDAwCV4C,GAAkB,SAAApJ,GACtB2G,EAAa,CACXtE,KAAMrC,EACNyG,MAAM,KAWJ4C,GAAY,uCAAG,4BAAAlB,EAAA,sEACKpB,EAAUuC,YAAW,CAAClD,EAAaxC,QAAQjF,WAAW,IAD3D,OACb4K,EADa,OAEnBxB,IAAQzC,KAAR,gBAAsBiE,EAAUjC,KAAK/I,MAFlB,2CAAH,qDAKlB0C,qBAAU,YACQ,uCAAG,8BAAAkH,EAAA,6DACjB9B,EAAS,CACPhE,KAAM,iBAERiE,EAAY,GAJK,kBAMQqC,IAAMa,IAAN,wBACJtD,EAAMuD,MAAMC,OAAO/K,UACpC,CACEkK,QAAS,CACPC,cAAe,UAAY3J,aAAaC,QAAQ,kBAVvC,OAMT2J,EANS,OAcf1C,EAAS,CACPhE,KAAM,aACNuB,QAASmF,EAASG,KAClBjK,MAAO8J,EAASG,KAAKjK,MACrBoF,SAAU0E,EAASG,KAAK7E,WAE1BsF,QAAQC,IAAIb,EAASG,MACfW,EACJd,EAASG,KAAKtD,UAAUpB,WACtB,SAACsB,GAAD,OAAOA,EAAEnH,WAAaQ,aAAaC,QAAQ,gBACxC,EACPoH,EAAeqD,GAzBA,kDA2BfF,QAAQC,IAAR,MACAvD,EAAS,CACPhE,KAAM,aACNwB,MACE,KAAIkF,UAAY,KAAIA,SAASG,MAAQ,KAAIH,SAASG,KAAKY,QACnD,KAAIf,SAASG,KAAKY,QAClB,KAAIA,UAjCG,0DAAH,qDAqChBC,KACC,CAAC7D,EAAMuD,MAAMC,OAAO/K,WAEvB,IAAMqL,GAAS,uCAAG,WAAOC,EAAKC,EAAUC,GAAtB,iBAAAhC,EAAA,sEACEiC,MAAMH,GADR,cACVI,EADU,gBAEUA,EAAIC,cAFd,cAEVA,EAFU,yBAGT,IAAIC,KAAK,CAACD,GAAcJ,EAAU,CAAE7H,KAAM8H,KAHjC,2CAAH,0DAMTK,GAAqB,SAACC,GAC1B,IAAMC,EAAoBD,EAAcE,OAASF,EAAcG,MAAS,IACxEvE,EAAS,CACPhE,KAAM,eACN0D,SAAU2E,KAIR3K,GAAgB,uCAAG,WAAO8K,EAAe7K,GAAtB,uBAAAmI,EAAA,sEACAQ,IAAMa,IAAI,gCAAkCxJ,EAAW,CAC5E6I,QAAS,CACPC,cACE,WAAa3B,GAAgBhI,aAAaC,QAAQ,mBAJjC,cACjB2J,EADiB,SAOIA,EAASG,KAA5Be,EAPe,EAOfA,IAAKa,EAPU,EAOVA,UACbnB,QAAQC,IAAIb,EAASG,MARE,SASDc,GACpBa,EAD6B,UAE1BzD,EAAYzI,UAAYQ,aAAaC,QAAQ,YAFnB,QAG7B,aAZqB,cASjB2L,EATiB,0BAefpC,IAAMC,IAAIqB,EAAKc,EAAS,CAC5BlC,QAAS,CACP,eAAgB,aAElBmC,iBAAgC,eAAdhL,EAA6BwK,GAAoB,OAnBhD,WAsBH,eAAdxK,EAtBiB,wBAuBnB+G,EAAU,CACR1E,KAAM4I,qBACNjM,WAAY8L,EAAY,KAAM,IAAIhM,MAAOoM,YAE3C7E,EAAS,CACPhE,KAAM,qBACNrD,WAAY8L,EAAY,KAAM,IAAIhM,MAAOoM,YA7BxB,UA+BbvC,IAAMC,IAAI,yBAA0B,CAACkC,UAAWA,GAAY,CAChEjC,QAAS,CACPC,cACE,WAAa3B,GAAgBhI,aAAaC,QAAQ,mBAlCrC,uCAsCnB2H,EAAU,CACR1E,KAAM8I,qBACNnF,WAAY8E,EAAY,KAAM,IAAIhM,MAAOoM,YAE3C7E,EAAS,CACPhE,KAAM,qBACN2D,WAAY8E,EAAY,KAAM,IAAIhM,MAAOoM,YA5CxB,UA8CbvC,IAAMC,IAAI,yBAA0B,CAACkC,UAAWA,GAAY,CAChEjC,QAAS,CACPC,cACE,WAAa3B,GAAgBhI,aAAaC,QAAQ,mBAjDrC,QAqDrBqI,IAAMK,QAAQ,+BArDO,kDAuDrB6B,QAAQC,IAAR,MAvDqB,0DAAH,wDAyMtB,OACE,sBAAKzH,UAAU,UAAf,WACIiE,EAAazC,aAAeyC,EAAaxC,QACzC,qCACE,+BACGwC,EAAaxC,QAAQpF,UADxB,IACoC4H,EAAaxC,QAAQlF,YAjJ7D,qCACE,sBAAKyD,UAAU,aAAagB,MAAO,CACjCiI,iBAAkBhF,EAAaxC,QAAQoC,YAAc,WADvD,UAGE,wBACI7D,UAAU,mBACVC,QAAS,kBAAMgH,GAAgB,eAC/BjG,MAAO,CACLkI,SACGjF,EAAaxC,QAAQjF,WACpBQ,aAAaC,QAAQ,aACrBgH,EAAapC,6BACf,QAEJR,SAAU4C,EAAapC,2BAV3B,SAYI,mBAAG7B,UAAU,oBAGfiE,EAAaxC,QAAQoC,YAErB,qBACE5C,IAAKgD,EAAaxC,QAAQoC,WAC1BsF,IAAKlF,EAAaxC,QAAQjF,cAIhC,sBAAKwD,UAAU,aAAf,UACE,qBACEiB,IAAKgD,EAAaxC,QAAQ5E,WAC1BsM,IAAKlF,EAAaxC,QAAQjF,SAC1BwE,MAAO,CACLoI,aAAcnF,EAAapC,2BACvB,YACA,OACJY,OAAQwB,EAAapC,2BACjB,YACA,OACJwH,SAAUpF,EAAapC,2BACnB,YACA,UAGR,wBACE7B,UAAU,SACVC,QAAS,kBAAMgH,GAAgB,eAC/BjG,MAAO,CACLkI,SACGjF,EAAaxC,QAAQjF,WACpBQ,aAAaC,QAAQ,aACrBgH,EAAapC,6BACf,QAEJR,SAAU4C,EAAapC,2BAVzB,SAYE,mBAAG7B,UAAU,oBAEdiE,EAAapC,4BACZ,qBAAK7B,UAAU,cAAf,SACE,cAAC,IAAD,CAAQsJ,QAAQ,KAAKC,YAAY,IAAIC,YAAY,iBAIvD,sBACExJ,UAAU,iBACVgB,MAAO,CACLkI,QACEjF,EAAaxC,QAAQjF,YACpByI,EACGA,EAAYzI,SACZQ,aAAaC,QAAQ,aACrB,OACA,QATV,UAYGiI,EAAc,cAACuE,EAAA,EAAD,CAASpL,MAAM,SAAW,wBAAQ2B,UAAU,QAAQC,QAASiH,GAAnC,SACvC,mBAAGlH,UAAU,qBAEf,wBACEA,UAAU,SACVC,QAASsG,GACTlF,SAAU4C,EAAarC,cACvBZ,MAAO,CACLiI,gBAAiB7E,EAAc,UAAY,QAC3CsF,MAAOtF,EAAc,QAAU,WANnC,SASGA,EAAc,YAAc,cAGjC,sBACEpE,UAAU,cACVgB,MAAO,CACL2I,UACE1F,EAAaxC,QAAQjF,YACpByI,EACGA,EAAYzI,SACZQ,aAAaC,QAAQ,aACrB,OACA,QATV,UAYE,oBAAG+C,UAAU,gBAAb,UACGiE,EAAaxC,QAAQpF,UADxB,IACoC4H,EAAaxC,QAAQlF,YAEzD,oBAAGyD,UAAU,WAAb,cAA0BiE,EAAaxC,QAAQjF,YAC/C,sBAAKwD,UAAU,qBAAf,UACE,oBAAGC,QAAS,kBAAMkG,GAAe,IAAjC,UACE,+BAAOlC,EAAaxC,QAAQ4E,UAAU5F,SADxC,gBAGA,oBAAGR,QAAS,kBAAMkG,GAAe,IAAjC,UACE,+BAAOlC,EAAaxC,QAAQgC,UAAUhD,SADxC,sBAKJ,qBAAKT,UAAU,OAAf,SACE,cAAC,EAAD,CACE1E,YAAaA,EACbD,kBAAmBA,EACnBD,WAAYA,EACZD,oBAAqBA,EACrBI,kBAAmBA,EACnBC,qBAAsBA,EACtBN,MACe,IAAb0H,EACIqB,EAAatC,yBACbsC,EAAaxC,QAAQoB,QAE3BpH,eAAgBA,EAChBC,YAAaA,EACbE,aAA2B,IAAbgH,EACdjH,eAAgBA,EAChBG,aAAcmJ,GAAeA,EAAY2E,WAAa3E,EAAY2E,WAAWxN,IAAK,KAClFP,QAASA,aAiBb,cAAC4N,EAAA,EAAD,CAASpL,MAAM,OAEhBkG,EAAUD,MACT,cAAC,EAAD,CACEU,MAAOA,EACPxI,SAAUyI,EAAYzI,UAAYQ,aAAaC,QAAQ,YACvDU,iBA5RiB,WACvB6G,EAAa,CACXtE,KAAM,aACNoE,MAAM,KA0RF1G,iBAAkBA,GAClBC,UAAW0G,EAAUrE,Y,kLC5mBlB2J,EAAc,SAAAC,GACvB,8CAAO,WAAO5F,EAAU6F,GAAjB,mBAAA/D,EAAA,sEAEC9B,EAAS,CAAChE,KAAM8J,iBACVhF,EAAQ+E,IAAWhF,MAAQgF,IAAWhF,KAAKC,MAAQ+E,IAAWhF,KAAKC,MAAOhI,aAAaC,QAAQ,eAHtG,SAIsBuJ,IAAMa,IAAN,mCAAsCyC,GAAU,CACjEpD,QAAS,CACLC,cAAe,UAAY3B,KANpC,gBAIQ+B,EAJR,EAIQA,KAKP7C,EAAS,CACLhE,KAAM+J,sBACN9E,KAAM4B,IAXX,kDAcC7C,EAAS,CACLhE,KAAMgK,sBACNxI,MAAO,KAAIkF,UAAY,KAAIA,SAASG,MAAQ,KAAIH,SAASG,KAAKY,QAC5D,KAAIf,SAASG,KAAKY,QAClB,KAAIA,UAlBX,0DAAP,yDAyBSR,EAAa,SAACgD,EAAOC,GAC9B,8CAAO,WAAOlG,EAAU6F,GAAjB,mBAAA/D,EAAA,sEAEC9B,EAAS,CAAChE,KAAM8J,iBAFjB,SAGsBxD,IAAMvK,KAAN,uCAA2CmO,GAAe,CAACD,SAAQ,CACpFzD,QAAS,CACLC,cAAe,WAAaoD,IAAWhF,KAAKC,OAAShI,aAAaC,QAAQ,mBALnF,uBAGQ8J,EAHR,EAGQA,KAHR,SAQsB7C,EAAS,CAC1BhE,KAAMmK,cACNlF,KAAM4B,IAVX,cAQOlG,EARP,yBAYQA,GAZR,kCAcC2G,QAAQC,IAAR,MAdD,0DAAP,yDAoBS6C,EAAiB,SAACR,EAAQS,GACnC,8CAAO,WAAOrG,EAAU6F,GAAjB,SAAA/D,EAAA,+EAEOQ,IAAMC,IAAN,sCAAyCqD,GAAU,CAACS,YAAW,CACjE7D,QAAS,CACLC,cAAe,WAAaoD,IAAWhF,KAAKC,OAAShI,aAAaC,QAAQ,mBAJnF,OAOCiH,EAAS,CACLhE,KAAMsK,mBACND,SAAUA,IATf,+CAYC/C,QAAQC,IAAR,MAZD,wDAAP","file":"static/js/13.b67643f9.chunk.js","sourcesContent":["import React from \"react\";\r\nimport \"./Tabs.scss\";\r\nimport { Tab, Tabs, TabList, TabPanel } from \"react-tabs\";\r\nimport \"react-tabs/style/react-tabs.css\";\r\nimport Post from \"../../Homepage/PostsList/Post/Post\";\r\n\r\nconst timeDifference = (current, previous) => {\r\n  const msPerMinute = 60 * 1000;\r\n  const msPerHour = msPerMinute * 60;\r\n  const msPerDay = msPerHour * 24;\r\n  const msPerMonth = msPerDay * 30;\r\n  const msPerYear = msPerDay * 365;\r\n\r\n  const elapsed = current - previous;\r\n\r\n  if (elapsed < msPerMinute) {\r\n    if (elapsed / 1000 < 30) return \"Just Now\";\r\n    return Math.round(elapsed / 1000) + \" seconds ago\";\r\n  } else if (elapsed < msPerHour) {\r\n    return Math.round(elapsed / msPerMinute) + \" minutes ago\";\r\n  } else if (elapsed < msPerDay) {\r\n    return Math.round(elapsed / msPerHour) + \" hours ago\";\r\n  } else if (elapsed < msPerMonth) {\r\n    return Math.round(elapsed / msPerDay) + \" days ago\";\r\n  } else if (elapsed < msPerYear) {\r\n    return Math.round(elapsed / msPerMonth) + \" months ago\";\r\n  } else {\r\n    return Math.round(elapsed / msPerYear) + \" years ago\";\r\n  }\r\n};\r\n\r\nconst TabsPosts = ({\r\n  posts,\r\n  deletePostReqGoHome,\r\n  retweetReq,\r\n  viewSinglePostReq,\r\n  likePostReq,\r\n  postActionLoading,\r\n  retweetActionLoading,\r\n  selectTabIndex,\r\n  goToProfile,\r\n  submitReplyReq,\r\n  disableReply,\r\n  pinPost,\r\n  pinnedPostId\r\n}) => {\r\n\r\n  const renderPosts = posts.map((post) => {\r\n    return (\r\n      <Post\r\n        key={post._id}\r\n        postId={post._id}\r\n        firstName={post.postedBy.firstName}\r\n        lastName={post.postedBy.lastName}\r\n        username={post.postedBy.username}\r\n        content={post.content}\r\n        createdAt={timeDifference(\r\n          new Date(),\r\n          new Date(post.content ? post.createdAt : post.retweetData.createdAt)\r\n        )}\r\n        profilePic={post.postedBy.profilePic}\r\n        likePostReq={likePostReq}\r\n        likes={post.likes}\r\n        postActionLoading={postActionLoading}\r\n        loggedInUsername={localStorage.getItem(\"userName\")}\r\n        retweetReq={retweetReq}\r\n        retweetActionLoading={retweetActionLoading}\r\n        retweetUsers={post.retweetUsers}\r\n        retweetData={post.retweetData}\r\n        combineretweetsAndPosts={true}\r\n        replyTo={post.replyTo || null}\r\n        replyToUsername={\r\n          post.replyTo && post.replyTo.originalPost\r\n            ? post.replyTo.originalPost.postedBy.username\r\n            : null\r\n        }\r\n        replyPostTypeReplyToUsername={post.postedBy.username}\r\n        viewSinglePostReq={() => viewSinglePostReq(post._id, post.replyTo ? post.replyTo.originalPost._id: null)}\r\n        deletePost={deletePostReqGoHome}\r\n        goToProfile={goToProfile}\r\n        disableReply={disableReply}\r\n        pinPost={() => pinPost(post._id)}\r\n        pinnedPostId={pinnedPostId}\r\n        submitReplyReq={submitReplyReq}\r\n      />\r\n    );\r\n  });\r\n\r\n  return (\r\n    <Tabs onSelect={selectTabIndex}>\r\n      <TabList>\r\n        <Tab>Posts</Tab>\r\n        <Tab>Replies</Tab>\r\n      </TabList>\r\n\r\n      <TabPanel>\r\n        {renderPosts}\r\n      </TabPanel>\r\n      <TabPanel>\r\n        {renderPosts}\r\n      </TabPanel>\r\n    </Tabs>\r\n  );\r\n};\r\n\r\nexport default TabsPosts;\r\n","import React, { useCallback, useEffect, useRef, useState } from \"react\";\r\nimport \"./ImageUploadModal.scss\";\r\nimport ReactCrop from \"react-image-crop\";\r\nimport \"react-image-crop/dist/ReactCrop.css\";\r\n\r\nconst ImageUploadModal = ({ closeUploadModal, uploadProfilePic, photoType }) => {\r\n  const [upImg, setUpImg] = useState();\r\n  const imgRef = useRef(null);\r\n  const previewCanvasRef = useRef(null);\r\n  const [crop, setCrop] = useState({ unit: \"%\", width: 30, aspect: photoType === 'profilePic' ? 16 / 16: 16 / 9 });\r\n  const [completedCrop, setCompletedCrop] = useState(null);\r\n\r\n  const onSelectFile = (e) => {\r\n    if (e.target.files && e.target.files.length > 0) {\r\n      const reader = new FileReader();\r\n      reader.addEventListener(\"load\", () => setUpImg(reader.result));\r\n      reader.readAsDataURL(e.target.files[0]);\r\n    }\r\n  };\r\n\r\n  const onLoad = useCallback((img) => {\r\n    imgRef.current = img;\r\n  }, []);\r\n\r\n  const uploadProfilePicReq = () => {\r\n    uploadProfilePic(previewCanvasRef.current.toDataURL(), photoType);\r\n    closeUploadModal();\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!completedCrop || !previewCanvasRef.current || !imgRef.current) {\r\n      return;\r\n    }\r\n\r\n    const image = imgRef.current;\r\n    const canvas = previewCanvasRef.current;\r\n    const crop = completedCrop;\r\n\r\n    const scaleX = image.naturalWidth / image.width;\r\n    const scaleY = image.naturalHeight / image.height;\r\n    const ctx = canvas.getContext(\"2d\");\r\n    const pixelRatio = window.devicePixelRatio;\r\n\r\n    canvas.width = crop.width * pixelRatio;\r\n    canvas.height = crop.height * pixelRatio;\r\n\r\n    ctx.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);\r\n    ctx.imageSmoothingQuality = \"high\";\r\n\r\n    ctx.drawImage(\r\n      image,\r\n      crop.x * scaleX,\r\n      crop.y * scaleY,\r\n      crop.width * scaleX,\r\n      crop.height * scaleY,\r\n      0,\r\n      0,\r\n      crop.width,\r\n      crop.height\r\n    );\r\n  }, [completedCrop]);\r\n\r\n  \r\n\r\n  return (\r\n    <div className=\"backdrop\">\r\n      <div className=\"replyModal\">\r\n        <div className=\"titleP\">\r\n          <h2>Upload A new {photoType === 'profilePic' ? 'Profile Picture': 'Cover Photo'}</h2>\r\n          <i className=\"fa fa-times\" onClick={closeUploadModal}></i>\r\n        </div>\r\n        <div className=\"fileInput\">\r\n          <input\r\n            type=\"file\"\r\n            name=\"image\"\r\n            accept=\"image/*\"\r\n            onChange={onSelectFile}\r\n          />\r\n          <canvas\r\n            ref={previewCanvasRef}\r\n            // Rounding is important so the canvas width and height matches/is a multiple for sharpness.\r\n            style={{\r\n              width: Math.round(completedCrop?.width ?? 0),\r\n              height: Math.round(completedCrop?.height ?? 0),\r\n            }}\r\n          />\r\n          <ReactCrop\r\n            src={upImg}\r\n            onImageLoaded={onLoad}\r\n            crop={crop}\r\n            onChange={(c) => setCrop(c)}\r\n            onComplete={(c) => setCompletedCrop(c)}\r\n          />\r\n        </div>\r\n        <div className=\"btnActions\">\r\n          <button className=\"btn btn-primary upload\" disabled={!crop || !previewCanvasRef.current} onClick={uploadProfilePicReq}>\r\n            Upload\r\n          </button>\r\n          <button className=\"btn btn-danger\" onClick={closeUploadModal}>\r\n            Cancel\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ImageUploadModal;\r\n","import React, { useEffect, useReducer, useRef, useState } from \"react\";\r\nimport \"./Profile.scss\";\r\nimport axios from \"../../axios\";\r\nimport Spinner from \"../Spinner/Spinner\";\r\nimport TabsPosts from \"./Tabs/Tabs\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport history from \"../../history\";\r\nimport {\r\n  deletePost,\r\n  likePost,\r\n  replyPost,\r\n  retweetPost,\r\n} from \"../../store/Actions/post\";\r\nimport { CHANGE_COVER_PHOTO, CHANGE_PROFILE_PIC, FOLLOW_USER } from \"../../store/Actions/actionTypes\";\r\nimport ImageUploadModal from \"./ImageUploadModal/ImageUploadModal\";\r\nimport { Circle } from \"rc-progress\";\r\nimport { pinPostUser } from \"../../store/Actions/user\";\r\nimport { toast } from \"react-toastify\";\r\nimport { createChat } from \"../../store/Actions/chat\";\r\n\r\nconst initialState = {\r\n  userLoading: false,\r\n  profile: null,\r\n  error: null,\r\n  combinedPostsAndRetweets: [],\r\n  followLoading: false,\r\n  imageUploadProgressRunning: false,\r\n  imageUploadProgress: 0,\r\n};\r\n\r\nconst reducer = (state, action) => {\r\n  switch (action.type) {\r\n    case \"user_loading\":\r\n      return {\r\n        ...state,\r\n        userLoading: true,\r\n        error: null,\r\n      };\r\n    case \"fetch_user\":\r\n      return {\r\n        ...state,\r\n        userLoading: false,\r\n        profile: action.profile,\r\n        combinedPostsAndRetweets: [\r\n          ...action.profile.posts,\r\n          ...action.profile.retweets,\r\n        ],\r\n        followLoading: false,\r\n      };\r\n    case \"user_error\":\r\n      return {\r\n        ...state,\r\n        error: action.error,\r\n        userLoading: false,\r\n        followLoading: false,\r\n      };\r\n    case \"retweet\":\r\n      let combinedPostsAndRetweetsForRetweet = [\r\n        ...state.combinedPostsAndRetweets,\r\n      ];\r\n      const targetedPostIndexForRetweet = combinedPostsAndRetweetsForRetweet.findIndex(\r\n        (o) => o._id === action.postId\r\n      );\r\n      let postretweetUsers = [\r\n        ...combinedPostsAndRetweetsForRetweet[targetedPostIndexForRetweet]\r\n          .retweetUsers,\r\n      ];\r\n      const retweetUsersIndex = postretweetUsers.findIndex(\r\n        (u) => u.username === localStorage.getItem(\"userName\")\r\n      );\r\n      if (retweetUsersIndex > -1) {\r\n        postretweetUsers = postretweetUsers.filter(\r\n          (u) => u.username !== localStorage.getItem(\"userName\")\r\n        );\r\n      } else {\r\n        postretweetUsers.unshift({\r\n          firstName: localStorage.getItem(\"firstName\"),\r\n          lastName: localStorage.getItem(\"lastName\"),\r\n          username: localStorage.getItem(\"userName\"),\r\n          profilePic: localStorage.getItem(\"profilePic\"),\r\n        });\r\n      }\r\n      combinedPostsAndRetweetsForRetweet[\r\n        targetedPostIndexForRetweet\r\n      ].retweetUsers = postretweetUsers;\r\n      return {\r\n        ...state,\r\n        profile: {\r\n          ...state.profile,\r\n          combinedPostsAndRetweets: combinedPostsAndRetweetsForRetweet,\r\n        },\r\n      };\r\n    case \"like_post\":\r\n      let postsArray = [...state.combinedPostsAndRetweets];\r\n      if (action.tabIndex === 1) {\r\n        postsArray = [...state.profile.replies];\r\n      }\r\n      const targetedPostIndex = postsArray.findIndex(\r\n        (o) => o._id === action.postId\r\n      );\r\n      const allPostLikes = [...postsArray[targetedPostIndex].likes];\r\n      const likeUserFoundIndex = allPostLikes.findIndex(\r\n        (like) => like.username === localStorage.getItem(\"userName\")\r\n      );\r\n      if (likeUserFoundIndex > -1) {\r\n        allPostLikes.splice(likeUserFoundIndex, 1);\r\n      } else {\r\n        allPostLikes.push({\r\n          firstName: localStorage.getItem(\"firstName\"),\r\n          lastName: localStorage.getItem(\"lastName\"),\r\n          username: localStorage.getItem(\"userName\"),\r\n          profilePic: localStorage.getItem(\"profilePic\"),\r\n        });\r\n      }\r\n      postsArray[targetedPostIndex].likes = allPostLikes;\r\n      if (action.tabIndex === 0) {\r\n        return {\r\n          ...state,\r\n          combinedPostsAndRetweets: postsArray,\r\n        };\r\n      } else {\r\n        return {\r\n          ...state,\r\n          profile: {\r\n            ...state.profile,\r\n            replies: postsArray,\r\n          },\r\n        };\r\n      }\r\n    case \"delete_reply_post\":\r\n      const allReplies = [...state.profile.replies];\r\n      const foundReplyPostIndex = allReplies.findIndex(\r\n        (r) => r._id === action.replyPostId\r\n      );\r\n      allReplies.splice(foundReplyPostIndex, 1);\r\n      return {\r\n        ...state,\r\n        profile: {\r\n          ...state.profile,\r\n          replies: [...allReplies],\r\n        },\r\n      };\r\n    case \"follow_loading\":\r\n      return {\r\n        ...state,\r\n        followLoading: true,\r\n      };\r\n    case \"follow_user\":\r\n      if (action.resType === \"Add\") {\r\n        return {\r\n          ...state,\r\n          profile: {\r\n            ...state.profile,\r\n            followers: [...state.profile.followers, action.follower],\r\n          },\r\n          followLoading: false,\r\n        };\r\n      } else {\r\n        return {\r\n          ...state,\r\n          profile: {\r\n            ...state.profile,\r\n            followers: state.profile.followers.filter(\r\n              (p) => p.username !== action.follower.username\r\n            ),\r\n          },\r\n          followLoading: false,\r\n        };\r\n      }\r\n    case \"image_upload\":\r\n      return {\r\n        ...state,\r\n        imageUploadProgressRunning: true,\r\n        imageUploadProgress: action.progress,\r\n      };\r\n    case \"change_profile_pic\":\r\n      return {\r\n        ...state,\r\n        imageUploadProgressRunning: false,\r\n        imageUploadProgress: 0,\r\n        profile: {\r\n          ...state.profile,\r\n          profilePic: action.profilePic\r\n        }\r\n      };\r\n    case \"change_cover_photo\":\r\n      return {\r\n        ...state,\r\n        imageUploadProgressRunning: false,\r\n        imageUploadProgress: 0,\r\n        profile: {\r\n          ...state.profile,\r\n          coverPhoto: action.coverPhoto\r\n        }\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nconst Profile = (props) => {\r\n  const [profileState, dispatch] = useReducer(reducer, initialState);\r\n  const [tabIndex, settabIndex] = useState(0);\r\n  const [ifFollowing, setifFollowing] = useState(false);\r\n  const [modalOpen, setModalOpen] = useState({open: false, type: 'profilePic'});\r\n\r\n  const pinToastId = useRef();\r\n  const replyToastId = useRef();\r\n  const retweetToastId = useRef();\r\n\r\n  const dispatch2 = useDispatch();\r\n  const { postActionLoading, retweetActionLoading } = useSelector(\r\n    (state) => state.post\r\n  );\r\n  const { token, userDetails } = useSelector((state) => state.user);\r\n  const { chatLoading } = useSelector((state) => state.chat);\r\n\r\n  const likePostReq = (postId, originalPostId) => {\r\n    dispatch2(likePost(postId, originalPostId));\r\n\r\n    // here if condition because there's already a reducer that does this dispatch in posts array\r\n    dispatch({\r\n      type: \"like_post\",\r\n      postId: postId,\r\n      tabIndex: tabIndex,\r\n    });\r\n  };\r\n\r\n  const retweetReq = (postId, originalPostId) => {\r\n    retweetToastId.current = toast.warning('Submitting Your retweet...');\r\n    dispatch2(retweetPost(postId, originalPostId)).then(() => {\r\n      toast.dismiss(retweetToastId.current);\r\n      toast.success('Retweet Success');\r\n    });\r\n    dispatch({\r\n      type: \"retweet\",\r\n      postId: postId,\r\n    });\r\n  };\r\n\r\n  const deletePostReqGoHome = (postId, originalPostId) => {\r\n    dispatch({ type: \"delete_reply_post\", replyPostId: postId });\r\n    dispatch2(deletePost(postId, originalPostId));\r\n  };\r\n\r\n  const viewSinglePostReq = (postId, replyPostId) => {\r\n    history.push(`/post/${replyPostId || postId}`, {\r\n      postId: replyPostId || postId,\r\n      backgroundGreenPostId: postId,\r\n    });\r\n  };\r\n\r\n  const goToProfile = (username) => {\r\n    history.push(`/profile/${username}`);\r\n  };\r\n\r\n  const selectTabIndex = (tabindex) => {\r\n    settabIndex(tabindex);\r\n  };\r\n\r\n  const submitReplyReq = async (formData, postId) => {\r\n    replyToastId.current = toast.warning('Submitting Your Reply...');\r\n    const result = await dispatch2(replyPost(formData.reply, postId));\r\n    toast.dismiss(replyToastId.current);\r\n    toast.success('Reply Post Success');\r\n    dispatch({\r\n      type: \"add_reply\",\r\n      reply: result.post,\r\n    });\r\n  };\r\n\r\n  const goToFollowList = (index) => {\r\n    history.push(`/profile/${profileState.profile.username}/follow`, {\r\n      tabIndex: index,\r\n      username: profileState.profile.username,\r\n      followers: profileState.profile.followers,\r\n      following: profileState.profile.following,\r\n      firstName: profileState.profile.firstName,\r\n      lastName: profileState.profile.lastName,\r\n    });\r\n  };\r\n\r\n  const pinPost = postId => {\r\n    pinToastId.current = toast.warning('Pinning Post...');\r\n    dispatch2(pinPostUser(postId)).then(() => {\r\n      toast.dismiss(pinToastId.current);\r\n      toast.success('Pin Post Success');\r\n    });\r\n  };\r\n\r\n  const followUser = async () => {\r\n    dispatch({\r\n      type: \"follow_loading\",\r\n    });\r\n    const response = await axios.put(\r\n      `/user/follow/${profileState.profile.username}`,\r\n      {},\r\n      {\r\n        headers: {\r\n          Authorization:\r\n            \"Bearer \" + token || localStorage.getItem(\"accessToken\"),\r\n        },\r\n      }\r\n    );\r\n    dispatch2({\r\n      type: FOLLOW_USER,\r\n      newfollowingUser:\r\n        response.data && response.data.newfollowingUser\r\n          ? response.data.newfollowingUser\r\n          : null,\r\n    });\r\n    dispatch({\r\n      type: \"follow_user\",\r\n      follower: {\r\n        firstName: userDetails.firstName,\r\n        lastName: userDetails.lastName,\r\n        email: userDetails.email,\r\n        profilePic: userDetails.profilePic,\r\n        username: userDetails.username,\r\n      },\r\n      resType: response.data.type,\r\n    });\r\n    toast.success(response.data.type === 'Add' ? `You are following ${response.data.newfollowingUser.firstName} ${response.data.newfollowingUser.lastName}`: `You unfollowed ${response.data.newfollowingUser.firstName} ${response.data.newfollowingUser.lastName}`);\r\n    if (response.data.type === \"Add\") {\r\n      setifFollowing(true);\r\n    } else {\r\n      setifFollowing(false);\r\n    }\r\n  };\r\n\r\n  const openUploadModal = photoType => {\r\n    setModalOpen({\r\n      type: photoType,\r\n      open: true\r\n    });\r\n  };\r\n\r\n  const closeUploadModal = () => {\r\n    setModalOpen({\r\n      type: 'profilePic',\r\n      open: false\r\n    });\r\n  };\r\n\r\n  const chatWithUser = async () => {\r\n    const disResult = await dispatch2(createChat([profileState.profile.username], false));\r\n    history.push(`/chat/${disResult.chat._id}`);\r\n  };\r\n\r\n  useEffect(() => {\r\n    const getProfile = async () => {\r\n      dispatch({\r\n        type: \"user_loading\",\r\n      });\r\n      settabIndex(0);\r\n      try {\r\n        const response = await axios.get(\r\n          `/user/profile/${props.match.params.username}`,\r\n          {\r\n            headers: {\r\n              Authorization: \"Bearer \" + localStorage.getItem(\"accessToken\"),\r\n            },\r\n          }\r\n        );\r\n        dispatch({\r\n          type: \"fetch_user\",\r\n          profile: response.data,\r\n          likes: response.data.likes,\r\n          retweets: response.data.retweets,\r\n        });\r\n        console.log(response.data);\r\n        const followUserBool =\r\n          response.data.followers.findIndex(\r\n            (p) => p.username === localStorage.getItem(\"userName\")\r\n          ) > -1;\r\n        setifFollowing(followUserBool);\r\n      } catch (err) {\r\n        console.log(err);\r\n        dispatch({\r\n          type: \"user_error\",\r\n          error:\r\n            err.response && err.response.data && err.response.data.message\r\n              ? err.response.data.message\r\n              : err.message,\r\n        });\r\n      }\r\n    };\r\n    getProfile();\r\n  }, [props.match.params.username]);\r\n\r\n  const urltoFile = async (url, filename, mimeType) => {\r\n    const res = await fetch(url);\r\n    const arrayBuffer = await res.arrayBuffer();\r\n    return new File([arrayBuffer], filename, { type: mimeType });\r\n  };\r\n\r\n  const fileUploadProgress = (progressEvent) => {\r\n    const percentageLoaded = (progressEvent.loaded / progressEvent.total) * 100;\r\n    dispatch({\r\n      type: \"image_upload\",\r\n      progress: percentageLoaded\r\n    });\r\n  };\r\n\r\n  const uploadProfilePic = async (base64DataUrl, photoType) => {\r\n    const response = await axios.get(\"/user/getSignedUrl?photoType=\" + photoType, {\r\n      headers: {\r\n        Authorization:\r\n          \"Bearer \" + (token ? token : localStorage.getItem(\"accessToken\")),\r\n      },\r\n    });\r\n    const { url, imagePath } = response.data;\r\n    console.log(response.data);\r\n    const fileObj = await urltoFile(\r\n      base64DataUrl,\r\n      `${userDetails.username || localStorage.getItem(\"userName\")}.png`,\r\n      \"image/png\"\r\n    );\r\n    try {\r\n      await axios.put(url, fileObj, {\r\n        headers: {\r\n          \"Content-Type\": \"image/png\",\r\n        },\r\n        onUploadProgress: photoType === 'profilePic' ? fileUploadProgress: null,\r\n      });\r\n\r\n      if (photoType === 'profilePic') {\r\n        dispatch2({\r\n          type: CHANGE_PROFILE_PIC,\r\n          profilePic: imagePath + '?' + new Date().getTime()\r\n        });\r\n        dispatch({\r\n          type: 'change_profile_pic',\r\n          profilePic: imagePath + '?' + new Date().getTime()\r\n        });\r\n        await axios.put('/user/changeProfilePic', {imagePath: imagePath}, {\r\n          headers: {\r\n            Authorization:\r\n              \"Bearer \" + (token ? token : localStorage.getItem(\"accessToken\")),\r\n          },\r\n        });\r\n      } else {\r\n        dispatch2({\r\n          type: CHANGE_COVER_PHOTO,\r\n          coverPhoto: imagePath + '?' + new Date().getTime()\r\n        });\r\n        dispatch({\r\n          type: 'change_cover_photo',\r\n          coverPhoto: imagePath + '?' + new Date().getTime()\r\n        });\r\n        await axios.put('/user/changeCoverPhoto', {imagePath: imagePath}, {\r\n          headers: {\r\n            Authorization:\r\n              \"Bearer \" + (token ? token : localStorage.getItem(\"accessToken\")),\r\n          },\r\n        });\r\n      }\r\n      toast.success('Your photo has been changed');\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n  };\r\n\r\n  const renderProfile = () => {\r\n    return (\r\n      <>\r\n        <div className=\"coverphoto\" style={{\r\n          backgroundColor: !profileState.profile.coverPhoto && '#00ACEE'\r\n        }}>\r\n          <button\r\n              className=\"cameraCoverPhoto\"\r\n              onClick={() => openUploadModal('coverPhoto')}\r\n              style={{\r\n                display:\r\n                  (profileState.profile.username !==\r\n                    localStorage.getItem(\"userName\") ||\r\n                    profileState.imageUploadProgressRunning) &&\r\n                  \"none\",\r\n              }}\r\n              disabled={profileState.imageUploadProgressRunning}\r\n            >\r\n              <i className=\"fas fa-camera\"></i>\r\n            </button>\r\n          {\r\n            profileState.profile.coverPhoto\r\n            &&\r\n            <img\r\n              src={profileState.profile.coverPhoto}\r\n              alt={profileState.profile.username}\r\n            />\r\n          }\r\n        </div>\r\n        <div className=\"profilePic\">\r\n          <img\r\n            src={profileState.profile.profilePic}\r\n            alt={profileState.profile.username}\r\n            style={{\r\n              WebkitFilter: profileState.imageUploadProgressRunning\r\n                ? \"blur(3px)\"\r\n                : \"none\",\r\n              filter: profileState.imageUploadProgressRunning\r\n                ? \"blur(3px)\"\r\n                : \"none\",\r\n              msFilter: profileState.imageUploadProgressRunning\r\n                ? \"blur(3px)\"\r\n                : \"none\",\r\n            }}\r\n          />\r\n          <button\r\n            className=\"camera\"\r\n            onClick={() => openUploadModal('profilePic')}\r\n            style={{\r\n              display:\r\n                (profileState.profile.username !==\r\n                  localStorage.getItem(\"userName\") ||\r\n                  profileState.imageUploadProgressRunning) &&\r\n                \"none\",\r\n            }}\r\n            disabled={profileState.imageUploadProgressRunning}\r\n          >\r\n            <i className=\"fas fa-camera\"></i>\r\n          </button>\r\n          {profileState.imageUploadProgressRunning && (\r\n            <div className=\"progressCir\">\r\n              <Circle percent=\"70\" strokeWidth=\"4\" strokeColor=\"#00875D\" />\r\n            </div>\r\n          )}\r\n        </div>\r\n        <div\r\n          className=\"emailfollowing\"\r\n          style={{\r\n            display:\r\n              profileState.profile.username ===\r\n              (userDetails\r\n                ? userDetails.username\r\n                : localStorage.getItem(\"userName\"))\r\n                ? \"none\"\r\n                : \"flex\",\r\n          }}\r\n        >\r\n          {chatLoading ? <Spinner width=\"30px\" />: <button className=\"email\" onClick={chatWithUser}>\r\n            <i className=\"fa fa-envelope\"></i>\r\n          </button>}\r\n          <button\r\n            className=\"follow\"\r\n            onClick={followUser}\r\n            disabled={profileState.followLoading}\r\n            style={{\r\n              backgroundColor: ifFollowing ? \"#00ACEE\" : \"white\",\r\n              color: ifFollowing ? \"white\" : \"#00ACEE\",\r\n            }}\r\n          >\r\n            {ifFollowing ? \"Following\" : \"Follow\"}\r\n          </button>\r\n        </div>\r\n        <div\r\n          className=\"userdetails\"\r\n          style={{\r\n            marginTop:\r\n              profileState.profile.username ===\r\n              (userDetails\r\n                ? userDetails.username\r\n                : localStorage.getItem(\"userName\"))\r\n                ? \"70px\"\r\n                : \"20px\",\r\n          }}\r\n        >\r\n          <p className=\"firstlastname\">\r\n            {profileState.profile.firstName} {profileState.profile.lastName}\r\n          </p>\r\n          <p className=\"username\">@{profileState.profile.username}</p>\r\n          <div className=\"followingfollowers\">\r\n            <p onClick={() => goToFollowList(0)}>\r\n              <span>{profileState.profile.following.length}</span> Following\r\n            </p>\r\n            <p onClick={() => goToFollowList(1)}>\r\n              <span>{profileState.profile.followers.length}</span> Followers\r\n            </p>\r\n          </div>\r\n        </div>\r\n        <div className=\"tabs\">\r\n          <TabsPosts\r\n            likePostReq={likePostReq}\r\n            viewSinglePostReq={viewSinglePostReq}\r\n            retweetReq={retweetReq}\r\n            deletePostReqGoHome={deletePostReqGoHome}\r\n            postActionLoading={postActionLoading}\r\n            retweetActionLoading={retweetActionLoading}\r\n            posts={\r\n              tabIndex === 0\r\n                ? profileState.combinedPostsAndRetweets\r\n                : profileState.profile.replies\r\n            }\r\n            selectTabIndex={selectTabIndex}\r\n            goToProfile={goToProfile}\r\n            disableReply={tabIndex === 1}\r\n            submitReplyReq={submitReplyReq}\r\n            pinnedPostId={userDetails && userDetails.pinnedPost ? userDetails.pinnedPost._id: null}\r\n            pinPost={pinPost}\r\n          />\r\n        </div>\r\n      </>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"profile\">\r\n      {!profileState.userLoading && profileState.profile ? (\r\n        <>\r\n          <h2>\r\n            {profileState.profile.firstName} {profileState.profile.lastName}\r\n          </h2>\r\n          {renderProfile()}\r\n        </>\r\n      ) : (\r\n        <Spinner width=\"60\" />\r\n      )}\r\n      {modalOpen.open && (\r\n        <ImageUploadModal\r\n          token={token}\r\n          username={userDetails.username || localStorage.getItem(\"userName\")}\r\n          closeUploadModal={closeUploadModal}\r\n          uploadProfilePic={uploadProfilePic}\r\n          photoType={modalOpen.type}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Profile;\r\n","import axios from '../../axios';\r\nimport { CHANGE_CHAT_NAME, CHAT_LOADING, CHAT_MESSAGES_ERROR, CREATE_CHAT, FETCH_CHAT_MESSAGES } from './actionTypes';\r\n\r\nexport const getChatMsgs = chatId => {\r\n    return async (dispatch, getState) => {\r\n        try {\r\n            dispatch({type: CHAT_LOADING});\r\n            const token = getState().user && getState().user.token ? getState().user.token: localStorage.getItem('accessToken');\r\n            const {data} = await axios.get(`/chat/getMessages?chatId=${chatId}`, {\r\n                headers: {\r\n                    Authorization: 'Bearer ' + token\r\n                }\r\n            });\r\n            dispatch({\r\n                type: FETCH_CHAT_MESSAGES,\r\n                chat: data\r\n            });\r\n        } catch(err) {\r\n            dispatch({\r\n                type: CHAT_MESSAGES_ERROR,\r\n                error: err.response && err.response.data && err.response.data.message\r\n                ? err.response.data.message\r\n                : err.message\r\n            });\r\n        }\r\n    };\r\n};\r\n\r\n\r\nexport const createChat = (users, isGroupChat) => {\r\n    return async (dispatch, getState) => {\r\n        try {\r\n            dispatch({type: CHAT_LOADING});\r\n            const {data} = await axios.post(`/chat/createChat?isGroupChat=${isGroupChat}`, {users}, {\r\n                headers: {\r\n                    Authorization: 'Bearer ' + (getState().user.token || localStorage.getItem('accessToken'))\r\n                }\r\n            });\r\n            const result = await dispatch({\r\n                type: CREATE_CHAT,\r\n                chat: data\r\n            });\r\n            return result;\r\n        } catch(err) {\r\n            console.log(err);\r\n        }\r\n    };\r\n};\r\n\r\n\r\nexport const changeChatName = (chatId, chatName) => {\r\n    return async (dispatch, getState) => {\r\n        try {\r\n            await axios.put(`/chat/changeChatName?chatId=${chatId}`, {chatName}, {\r\n                headers: {\r\n                    Authorization: 'Bearer ' + (getState().user.token || localStorage.getItem('accessToken'))\r\n                }\r\n            });\r\n            dispatch({\r\n                type: CHANGE_CHAT_NAME,\r\n                chatName: chatName\r\n            });\r\n        } catch(err) {\r\n            console.log(err);\r\n        }\r\n    };\r\n};"],"sourceRoot":""}